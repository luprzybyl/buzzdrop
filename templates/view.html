{% extends "base.html" %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <div class="bg-white shadow-md rounded-lg p-6 text-center">
        <h2 class="text-xl font-bold text-gray-800 mb-2">{{ original_name }}</h2>
        <p id="status" class="text-gray-600 mb-4">Enter password to {% if file_type == 'text' %}view{% else %}download and decrypt{% endif %}.</p>
        <input id="password-input" type="password" placeholder="Enter password" class="border p-2 rounded-md w-full mb-4">
        <button id="decrypt-btn" class="bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
            {% if file_type == 'text' %}Decrypt and View{% else %}Decrypt and Download{% endif %}
        </button>
        <p id="password-status" class="mt-2 text-sm text-green-600" style="display: none;">Password auto-filled. Click to proceed.</p>

        <!-- Text display area for notes -->
        <div id="text-display" class="mt-6 p-4 bg-gray-50 border border-gray-300 rounded-lg text-left" style="display: none;">
            <div class="flex justify-between items-center mb-2">
                <h3 class="font-semibold text-gray-800">Decrypted Text:</h3>
                <button id="copy-text-btn" class="text-sm bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded">Copy</button>
            </div>
            <pre id="text-content" class="whitespace-pre-wrap text-sm text-gray-700 max-h-96 overflow-y-auto"></pre>
        </div>
    </div>
</div>
<script>
window.downloadUrl = "{{ url_for('download_file', file_id=file_id) }}";
window.reportDecryptionUrl = "{{ url_for('report_decryption', file_id=file_id) }}";
window.originalName = "{{ original_name }}";
window.fileType = "{{ file_type }}";
</script>
<script src="{{ url_for('static', filename='js/view.js') }}"></script>
{% endblock %}
